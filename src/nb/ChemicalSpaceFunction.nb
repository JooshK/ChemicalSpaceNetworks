(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     14043,        354]
NotebookOptionsPosition[     12762,        322]
NotebookOutlinePosition[     13187,        339]
CellTagsIndexPosition[     13144,        336]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "@", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897478900315876*^9, 3.897478910494087*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"89a1c28e-04f8-490d-9f99-8b8f42a52b01"],

Cell[BoxData["\<\"/Users/joshuakhorsandi/Documents/Summer Research - 2023/WSS \
2023/Chem Space - \
#225/ChemicalSpaceNetworks/ChemicalSpaceNetworks/src/nb\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.89747890684892*^9, 3.897478910750794*^9}, 
   3.897479029722258*^9, 3.897483012666438*^9, {3.8974835959902687`*^9, 
   3.8974835963435507`*^9}},
 CellLabel->"Out[12]=",ExpressionUUID->"ea97796f-5ffb-40f0-98ec-33f66de3dc1d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<WolframChemistry`MoleculeFingerprints`\>\"", 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8974789144649773`*^9, 3.897478916491414*^9}, 
   3.897478993577964*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"dfc0a8e7-c3a8-4b33-9207-b299d1f1f1b6"],

Cell[BoxData[
 RowBox[{"<<", "../InputFunctions.wl"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897479033591215*^9, 3.897479055639122*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f44a5f93-15a8-4afb-86ab-f3af63db4ac2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateInput", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<BioData\>\"", "->", "False"}], "}"}], ",", 
     RowBox[{"Options", "[", "assignFingerprintsList", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateInput", "[", 
   RowBox[{"userInput_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dataset", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataset", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"StringQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"StringEndsQ", "[", 
          RowBox[{"userInput", ",", "\"\<.csv\>\""}], "]"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<BioData\>\"", "]"}], ",", 
          RowBox[{"generateDatasetBio", "[", "userInput", "]"}], ",", 
          RowBox[{"generateDataset", "[", "userInput", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"StringEndsQ", "[", 
          RowBox[{"userInput", ",", "\"\<.smi\>\""}], "]"}]}], ",", 
        RowBox[{"Import", "[", "userInput", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"moleculeListQ", "[", "userInput", "]"}]}], ",", "userInput",
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"validSmilesQ", "[", 
          RowBox[{"First", "@", "userInput"}], "]"}]}], ",", 
        RowBox[{"Molecule", "/@", "userInput"}], ",", "\[IndentingNewLine]", 
        "True", ",", "$Failed"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dataset", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "userInput", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"assignFingerprintsList", "[", 
        RowBox[{"dataset", ",", 
         RowBox[{"\"\<Fingerprint\>\"", "->", 
          RowBox[{"OptionValue", "[", "\"\<Fingerprint\>\"", "]"}]}]}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"assignFingerprints", "[", 
        RowBox[{"dataset", ",", 
         RowBox[{"\"\<Fingerprint\>\"", "->", 
          RowBox[{"OptionValue", "[", "\"\<Fingerprint\>\"", "]"}]}]}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897479115241159*^9, 3.897479117932796*^9}, {
  3.897479155795548*^9, 3.897479421685275*^9}, {3.8974794679746227`*^9, 
  3.8974796973315153`*^9}, {3.8974797492759123`*^9, 3.897479784869062*^9}, {
  3.897479849880074*^9, 3.897479952216669*^9}, {3.897480137399089*^9, 
  3.897480315294518*^9}, {3.897480444633507*^9, 3.8974804455415916`*^9}, {
  3.897480746223591*^9, 3.897480796633013*^9}, {3.89748108446107*^9, 
  3.897481110186071*^9}, {3.897481256735383*^9, 3.897481311948176*^9}, {
  3.897485622034177*^9, 3.897485647936686*^9}, {3.8974856827966957`*^9, 
  3.8974857151069098`*^9}},ExpressionUUID->"beb8e9ba-a476-41e4-ad6c-\
c0c6e6971a38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateGraphWithMols", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "MoleculeDistance", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Embedding\>\"", "->", "\"\<GravityEmbedding\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"generateGraphWithMols", "[", 
   RowBox[{"fingerprintData_Dataset", ",", "cutoff_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fingerprints", ",", "edges"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fingerprints", "=", 
      RowBox[{
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "[", "\"\<Fingerprint\>\"", "]"}]}], "}"}], "&"}], 
         ",", "fingerprintData"}], "]"}], "//", "Normal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"UndirectedEdge", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"First", "/@", "#"}]}], "]"}], "->", 
           RowBox[{
            RowBox[{"N", "@*", 
             RowBox[{"OptionValue", "[", "\"\<DistanceFunction\>\"", "]"}]}], 
            "@@", 
            RowBox[{"Last", "/@", "#"}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"fingerprints", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "//", "Association"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"edges", ",", 
         RowBox[{
          RowBox[{"#", "<=", "cutoff"}], "&"}]}], "]"}], "//", "Keys"}], "//", 
      RowBox[{
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Tooltip", "[", 
            RowBox[{"#", ",", 
             RowBox[{"MoleculePlot", "[", 
              RowBox[{"fingerprintData", "[", 
               RowBox[{"#", ",", "\"\<Molecule\>\""}], "]"}], "]"}]}], "]"}], 
           "&"}], "/@", 
          RowBox[{"Union", "@@", 
           RowBox[{"List", "@@@", "#"}]}]}], ",", "#", ",", 
         RowBox[{"GraphLayout", "->", 
          RowBox[{"OptionValue", "[", "\"\<Embedding\>\"", "]"}]}]}], "]"}], 
       "&"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897399782066596*^9, 3.897399862153706*^9}, {
   3.897399941520898*^9, 3.897399952123398*^9}, {3.8974001142541018`*^9, 
   3.897400182852281*^9}, {3.897400332913166*^9, 3.897400353301098*^9}, 
   3.8974005702610807`*^9, {3.897410454076426*^9, 3.8974104581600113`*^9}, {
   3.897410490718375*^9, 3.897410494034837*^9}, {3.897410541952479*^9, 
   3.897410546829124*^9}, {3.897410576934894*^9, 3.89741063720063*^9}, {
   3.897410969039617*^9, 3.8974109997105618`*^9}, {3.897411254447538*^9, 
   3.897411262887968*^9}, {3.89748045067345*^9, 3.8974804586205473`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f9965f40-3dfb-4084-a4a0-e97fc3161afd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateGraph", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "MoleculeDistance", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Embedding\>\"", "->", "\"\<GravityEmbedding\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"generateGraph", "[", 
   RowBox[{"fingerprintData_Dataset", ",", "cutoff_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fingerprints", ",", "edges"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fingerprints", "=", 
      RowBox[{
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "[", "\"\<Fingerprint\>\"", "]"}]}], "}"}], "&"}], 
         ",", "fingerprintData"}], "]"}], "//", "Normal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"UndirectedEdge", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"First", "/@", "#"}]}], "]"}], "->", 
           RowBox[{
            RowBox[{"N", "@*", 
             RowBox[{"OptionValue", "[", "\"\<DistanceFunction\>\"", "]"}]}], 
            "@@", 
            RowBox[{"Last", "/@", "#"}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"fingerprints", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "//", "Association"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"edges", ",", 
         RowBox[{
          RowBox[{"#", "<=", "cutoff"}], "&"}]}], "]"}], "//", "Keys"}], "//", 
      RowBox[{
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"Tooltip", "/@", 
          RowBox[{"Union", "@@", 
           RowBox[{"List", "@@@", "#"}]}]}], ",", "#", ",", 
         RowBox[{"GraphLayout", "->", 
          RowBox[{"OptionValue", "[", "\"\<Embedding\>\"", "]"}]}]}], "]"}], 
       "&"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897399782066596*^9, 3.897399862153706*^9}, {
   3.897399941520898*^9, 3.897399952123398*^9}, {3.8974001142541018`*^9, 
   3.897400182852281*^9}, {3.897400332913166*^9, 3.897400353301098*^9}, 
   3.8974005702610807`*^9, {3.897410454076426*^9, 3.8974104581600113`*^9}, {
   3.897410490718375*^9, 3.897410494034837*^9}, {3.897410541952479*^9, 
   3.897410546829124*^9}, {3.897410576934894*^9, 3.89741063720063*^9}, {
   3.897410969039617*^9, 3.8974109997105618`*^9}, {3.897411254447538*^9, 
   3.897411262887968*^9}, {3.897480478021673*^9, 3.897480514177174*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"b3f3e12d-3a33-474c-983d-40c43ba7d4db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "chemicalSpaceNetwork", "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Embed Molecules\>\"", "->", "False"}], "}"}], ",", 
     RowBox[{"Options", "[", "generateGraph", "]"}], ",", 
     RowBox[{"Options", "[", "generateInput", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chemicalSpaceNetwork", "[", 
   RowBox[{"userInput_", ",", "cutoff_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fingerprints", "=", 
      RowBox[{"generateInput", "[", "userInput", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"OptionValue", "[", "\"\<Embed Molecules\>\"", "]"}], ",", 
      RowBox[{"generateGraphWithMols", "[", 
       RowBox[{"fingerprints", ",", "cutoff"}], "]"}], ",", 
      RowBox[{"generateGraph", "[", 
       RowBox[{"fingerprints", ",", "cutoff"}], "]"}]}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897481361332405*^9, 3.897481611001762*^9}, 
   3.8974833033784037`*^9, {3.897483528008771*^9, 3.897483565734845*^9}, {
   3.897485612553891*^9, 
   3.897485616461391*^9}},ExpressionUUID->"9e3f27a0-8ae2-4642-8ed6-\
7d268d0f5131"]
},
WindowSize->{Full, Full},
WindowMargins->{{98, Automatic}, {Automatic, 65}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (June 8, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13b94586-7e1d-4065-a602-3880602b28b4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[583, 22, 271, 5, 57, "Input",ExpressionUUID->"89a1c28e-04f8-490d-9f99-8b8f42a52b01",
 InitializationCell->True],
Cell[857, 29, 445, 7, 42, "Output",ExpressionUUID->"ea97796f-5ffb-40f0-98ec-33f66de3dc1d",
 InitializationCell->True]
}, Open  ]],
Cell[1317, 39, 305, 6, 57, "Input",ExpressionUUID->"dfc0a8e7-c3a8-4b33-9207-b299d1f1f1b6",
 InitializationCell->True],
Cell[1625, 47, 235, 4, 57, "Input",ExpressionUUID->"f44a5f93-15a8-4afb-86ab-f3af63db4ac2",
 InitializationCell->True],
Cell[1863, 53, 3458, 75, 370, "Input",ExpressionUUID->"beb8e9ba-a476-41e4-ad6c-c0c6e6971a38",
 InitializationCell->True],
Cell[5324, 130, 3164, 79, 188, "Input",ExpressionUUID->"f9965f40-3dfb-4084-a4a0-e97fc3161afd",
 InitializationCell->True],
Cell[8491, 211, 2884, 72, 162, "Input",ExpressionUUID->"b3f3e12d-3a33-474c-983d-40c43ba7d4db",
 InitializationCell->True],
Cell[11378, 285, 1380, 35, 110, "Input",ExpressionUUID->"9e3f27a0-8ae2-4642-8ed6-7d268d0f5131",
 InitializationCell->True]
}
]
*)

