(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='WolframDesktop 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       161,          7]
NotebookDataLength[     47259,       1050]
NotebookOptionsPosition[     44801,       1001]
NotebookOutlinePosition[     45226,       1018]
CellTagsIndexPosition[     45183,       1015]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "@", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897478900315876*^9, 3.897478910494087*^9}, {
  3.897907155946089*^9, 3.897907181582858*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"89a1c28e-04f8-490d-9f99-8b8f42a52b01"],

Cell[BoxData["\<\"/Users/joshuakhorsandi/Documents/Summer Research - 2023/WSS \
2023/Chem Space - \
#225/ChemicalSpaceNetworks/ChemicalSpaceNetworks/src/nb\"\>"], "Output",
 InitializationCell->True,
 CellChangeTimes->{{3.89747890684892*^9, 3.897478910750794*^9}, 
   3.897479029722258*^9, 3.897483012666438*^9, {3.8974835959902687`*^9, 
   3.8974835963435507`*^9}, {3.8975049240045443`*^9, 
   3.8975049244082336`*^9}, {3.897556935181674*^9, 3.897556935649167*^9}, {
   3.8975704569865522`*^9, 3.897570457062952*^9}, 3.89757387453274*^9, 
   3.89757493853915*^9, 3.897596906167899*^9, 3.897641387020924*^9, 
   3.897651960773703*^9, 3.897661177821582*^9, 3.897902236381835*^9, 
   3.8979023005656137`*^9, 3.897903023737249*^9, {3.897907161838517*^9, 
   3.8979071826681957`*^9}},
 CellLabel->
  "Out[125]=",ExpressionUUID->"f4ac12c7-aad5-417d-bea2-051d5d311eca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "\"\<IGraphM`\>\""}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[127]:=",ExpressionUUID->"f3045fcd-3c29-4015-aafe-d45fbe3c7fbf"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"IGraph/M 0.6.5 (December 21, 2022)\"\>"},
    {"\<\"Evaluate \\!\\(\\*ButtonBox[\\\"IGDocumentation[]\\\",BaseStyle->\\\
\"Link\\\",ButtonData->\\\"paclet:IGraphM\\\"]\\) to get started.\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.897907178127243*^9, 3.897907190610128*^9}},
 CellLabel->
  "Out[127]=",ExpressionUUID->"c587e3bb-c9ea-4017-a7f9-16a1a2206820"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<WolframChemistry`MoleculeFingerprints`\>\"", 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8974789144649773`*^9, 3.897478916491414*^9}, 
   3.897478993577964*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"dfc0a8e7-c3a8-4b33-9207-b299d1f1f1b6"],

Cell[BoxData[
 RowBox[{"<<", "../InputFunctions.wl"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897479033591215*^9, 3.897479055639122*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"f44a5f93-15a8-4afb-86ab-f3af63db4ac2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"defualtpKiToColor", "[", "pKi_", "]"}], ":=", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pKi", "<", "5"}], ",", 
    RowBox[{"Darker", "@", "Red"}], ",", "\[IndentingNewLine]", 
    RowBox[{"5", "<=", "pKi", "<", "6"}], ",", "Red", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"6", "<=", "pKi", "<", "7"}], ",", "Orange", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"7", "<=", "pKi", "<", "8"}], ",", "Yellow", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"8", "<=", "pKi", "<", "9"}], ",", 
    RowBox[{"Darker", "@", "Green"}], ",", "\[IndentingNewLine]", 
    RowBox[{"9", "<=", "pKi", "<", "10"}], ",", "LightBlue", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"10", "<=", "pKi"}], ",", "Blue", ",", "True", ",", "White"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897504212368429*^9, 3.897504298329755*^9}, {
   3.8975049888810167`*^9, 3.897505019968595*^9}, 3.897559031892308*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"e19d7f81-6f45-4e16-b11e-8a6d9f3bb150"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateInput", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<BioData\>\"", "->", "False"}], "}"}], ",", 
     RowBox[{"Options", "[", "assignFingerprintsList", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateInput", "[", 
   RowBox[{"userInput_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dataset", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataset", "=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"StringQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"StringEndsQ", "[", 
          RowBox[{"userInput", ",", "\"\<.csv\>\""}], "]"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{"OptionValue", "[", "\"\<BioData\>\"", "]"}], "]"}], ",", 
          RowBox[{"generateDatasetBio", "[", "userInput", "]"}], ",", 
          RowBox[{"generateDataset", "[", "userInput", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"StringQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"StringEndsQ", "[", 
          RowBox[{"userInput", ",", "\"\<.smi\>\""}], "]"}]}], ",", 
        RowBox[{"Import", "[", "userInput", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"moleculeListQ", "[", "userInput", "]"}]}], ",", "userInput",
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListQ", "[", "userInput", "]"}], "&&", 
         RowBox[{"validSmilesQ", "[", 
          RowBox[{"First", "@", "userInput"}], "]"}]}], ",", 
        RowBox[{"Molecule", "/@", "userInput"}], ",", "\[IndentingNewLine]", 
        "True", ",", "$Failed"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dataset", "===", "$Failed"}], ",", 
       RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "userInput", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"assignFingerprintsList", "[", 
        RowBox[{"dataset", ",", 
         RowBox[{"\"\<Fingerprint\>\"", "->", 
          RowBox[{"OptionValue", "[", "\"\<Fingerprint\>\"", "]"}]}]}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"$fingerprintData", "=", 
        RowBox[{"assignFingerprints", "[", 
         RowBox[{"dataset", ",", 
          RowBox[{"\"\<Fingerprint\>\"", "->", 
           RowBox[{"OptionValue", "[", "\"\<Fingerprint\>\"", "]"}]}]}], 
         "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897479115241159*^9, 3.897479117932796*^9}, {
  3.897479155795548*^9, 3.897479421685275*^9}, {3.8974794679746227`*^9, 
  3.8974796973315153`*^9}, {3.8974797492759123`*^9, 3.897479784869062*^9}, {
  3.897479849880074*^9, 3.897479952216669*^9}, {3.897480137399089*^9, 
  3.897480315294518*^9}, {3.897480444633507*^9, 3.8974804455415916`*^9}, {
  3.897480746223591*^9, 3.897480796633013*^9}, {3.89748108446107*^9, 
  3.897481110186071*^9}, {3.897481256735383*^9, 3.897481311948176*^9}, {
  3.897485622034177*^9, 3.897485647936686*^9}, {3.8974856827966957`*^9, 
  3.8974857151069098`*^9}, {3.8974980917894287`*^9, 3.89749809763855*^9}, {
  3.897643812910112*^9, 3.897643816152894*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"beb8e9ba-a476-41e4-ad6c-c0c6e6971a38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateGraphWithMols", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "MoleculeDistance", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Embedding\>\"", "->", "\"\<GravityEmbedding\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"generateGraphWithMols", "[", 
   RowBox[{"fingerprintData_Dataset", ",", "cutoff_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fingerprints", ",", "edges"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fingerprints", "=", 
      RowBox[{
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "[", "\"\<Fingerprint\>\"", "]"}]}], "}"}], "&"}], 
         ",", "fingerprintData"}], "]"}], "//", "Normal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"UndirectedEdge", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"First", "/@", "#"}]}], "]"}], "->", 
           RowBox[{
            RowBox[{"N", "@*", 
             RowBox[{"OptionValue", "[", "\"\<DistanceFunction\>\"", "]"}]}], 
            "@@", 
            RowBox[{"Last", "/@", "#"}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"fingerprints", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "//", "Association"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"edges", ",", 
         RowBox[{
          RowBox[{"#", "<=", "cutoff"}], "&"}]}], "]"}], "//", "Keys"}], "//", 
      RowBox[{
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Tooltip", "[", 
            RowBox[{"#", ",", 
             RowBox[{"MoleculePlot", "[", 
              RowBox[{"fingerprintData", "[", 
               RowBox[{"#", ",", "\"\<Molecule\>\""}], "]"}], "]"}]}], "]"}], 
           "&"}], "/@", 
          RowBox[{"Union", "@@", 
           RowBox[{"List", "@@@", "#"}]}]}], ",", "#", ",", 
         RowBox[{"GraphLayout", "->", 
          RowBox[{"OptionValue", "[", "\"\<Embedding\>\"", "]"}]}]}], "]"}], 
       "&"}]}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897399782066596*^9, 3.897399862153706*^9}, {
   3.897399941520898*^9, 3.897399952123398*^9}, {3.8974001142541018`*^9, 
   3.897400182852281*^9}, {3.897400332913166*^9, 3.897400353301098*^9}, 
   3.8974005702610807`*^9, {3.897410454076426*^9, 3.8974104581600113`*^9}, {
   3.897410490718375*^9, 3.897410494034837*^9}, {3.897410541952479*^9, 
   3.897410546829124*^9}, {3.897410576934894*^9, 3.89741063720063*^9}, {
   3.897410969039617*^9, 3.8974109997105618`*^9}, {3.897411254447538*^9, 
   3.897411262887968*^9}, {3.89748045067345*^9, 3.8974804586205473`*^9}, {
   3.8975706378293743`*^9, 3.897570686269931*^9}, {3.897571736950179*^9, 
   3.897571747324896*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"f9965f40-3dfb-4084-a4a0-e97fc3161afd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "generateGraph", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Options", "[", "MoleculeDistance", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Embedding\>\"", "->", "\"\<GravityEmbedding\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"generateGraph", "[", 
   RowBox[{"fingerprintData_Dataset", ",", "cutoff_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fingerprints", ",", "edges", ",", "vertices", ",", "style", ",", 
      "graph"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fingerprints", "=", 
      RowBox[{
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "[", "\"\<Fingerprint\>\"", "]"}]}], "}"}], "&"}], 
         ",", "fingerprintData"}], "]"}], "//", "Normal"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{
       RowBox[{"ParallelMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"UndirectedEdge", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"First", "/@", "#"}]}], "]"}], "->", 
           RowBox[{
            RowBox[{"N", "@*", 
             RowBox[{"OptionValue", "[", "\"\<DistanceFunction\>\"", "]"}]}], 
            "@@", 
            RowBox[{"Last", "/@", "#"}]}]}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{"fingerprints", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "//", "Association"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"edges", ",", 
          RowBox[{
           RowBox[{"#", "<=", "cutoff"}], "&"}]}], "]"}], "//", "Keys"}], "//", 
       RowBox[{
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{"Tooltip", "/@", 
           RowBox[{"Union", "@@", 
            RowBox[{"List", "@@@", "#"}]}]}], ",", "#", ",", 
          RowBox[{"GraphLayout", "->", 
           RowBox[{"OptionValue", "[", "\"\<Embedding\>\"", "]"}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetProperty", "[", 
      RowBox[{"graph", ",", 
       RowBox[{"EdgeWeight", "->", 
        RowBox[{"Normal", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "-", "#"}], "&"}], ",", "edges"}], "]"}]}]}]}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897399782066596*^9, 3.897399862153706*^9}, {
   3.897399941520898*^9, 3.897399952123398*^9}, {3.8974001142541018`*^9, 
   3.897400182852281*^9}, {3.897400332913166*^9, 3.897400353301098*^9}, 
   3.8974005702610807`*^9, {3.897410454076426*^9, 3.8974104581600113`*^9}, {
   3.897410490718375*^9, 3.897410494034837*^9}, {3.897410541952479*^9, 
   3.897410546829124*^9}, {3.897410576934894*^9, 3.89741063720063*^9}, {
   3.897410969039617*^9, 3.8974109997105618`*^9}, {3.897411254447538*^9, 
   3.897411262887968*^9}, {3.897480478021673*^9, 3.897480514177174*^9}, {
   3.897505043387877*^9, 3.897505064576158*^9}, {3.897505129536125*^9, 
   3.8975051317263536`*^9}, {3.897505183580278*^9, 3.897505257478385*^9}, 
   3.897505322936893*^9, {3.897558885092751*^9, 3.897558904709608*^9}, {
   3.897558957366077*^9, 3.8975589591861553`*^9}, {3.897570546008432*^9, 
   3.897570572226163*^9}, {3.897570915196788*^9, 3.897570930944901*^9}, {
   3.897571020824423*^9, 3.897571099713973*^9}, 3.8975711967095013`*^9, {
   3.897571759702993*^9, 3.897571806665814*^9}, {3.897571856550454*^9, 
   3.897571858575658*^9}, {3.8979080127843103`*^9, 3.897908084377533*^9}, 
   3.897908131533079*^9, {3.8979082136253433`*^9, 3.897908219780442*^9}, {
   3.897908342644125*^9, 3.897908357948946*^9}, {3.897908452388897*^9, 
   3.8979084816155663`*^9}, {3.89790851799086*^9, 3.89790859634573*^9}, {
   3.897908655598311*^9, 3.897908668970755*^9}, 3.8979086991824083`*^9},
 CellLabel->
  "In[160]:=",ExpressionUUID->"b3f3e12d-3a33-474c-983d-40c43ba7d4db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "chemicalSpaceNetwork", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Embed Molecules\>\"", "->", "False"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Coloring\>\"", "->", "defualtpKiToColor"}], "}"}], ",", 
    RowBox[{"Options", "[", "generateGraph", "]"}], ",", 
    RowBox[{"Options", "[", "generateInput", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chemicalSpaceNetwork", "[", 
   RowBox[{"userInput_", ",", "cutoff_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fingerprints", ",", "vertices", ",", "style", ",", "graph", ",", 
      "legend"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fingerprints", "=", 
      RowBox[{"generateInput", "[", 
       RowBox[{"userInput", ",", 
        RowBox[{"\"\<BioData\>\"", "->", 
         RowBox[{"OptionValue", "[", "\"\<BioData\>\"", "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "\"\<Embed Molecules\>\"", "]"}], ",", 
        RowBox[{"generateGraphWithMols", "[", 
         RowBox[{"fingerprints", ",", "cutoff"}], "]"}], ",", 
        RowBox[{"generateGraph", "[", 
         RowBox[{"fingerprints", ",", "cutoff"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "graph"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"OptionValue", "[", "\"\<BioData\>\"", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vertices", "=", 
        RowBox[{"VertexList", "[", "graph", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"style", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "->", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Coloring\>\"", "]"}], "[", 
            RowBox[{"fingerprints", "[", 
             RowBox[{"#", ",", "\"\<pKi\>\""}], "]"}], "]"}]}], "&"}], "/@", 
         "vertices"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"legend", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"OptionValue", "[", "\"\<Coloring\>\"", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "11"}], "}"}]}], "}"}], ",", "6"}], "]"}], 
           ",", 
           RowBox[{"Rotate", "[", 
            RowBox[{"\"\<pKi\>\"", ",", 
             RowBox[{"90", "Degree"}]}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SetProperty", "[", 
         RowBox[{"graph", ",", 
          RowBox[{"VertexStyle", "->", "style"}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"Legended", "[", 
          RowBox[{"#", ",", "legend"}], "]"}], "&"}]}]}], ",", "graph"}], 
     "]"}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.897481361332405*^9, 3.897481611001762*^9}, 
   3.8974833033784037`*^9, {3.897483528008771*^9, 3.897483565734845*^9}, {
   3.897485612553891*^9, 3.897485616461391*^9}, {3.897505326127446*^9, 
   3.8975055014697237`*^9}, {3.8975055441520157`*^9, 
   3.8975056710249033`*^9}, {3.897505759020356*^9, 3.8975057660996637`*^9}, {
   3.897505889288478*^9, 3.897505981788474*^9}, 3.897506310772434*^9, {
   3.897559070054261*^9, 3.8975590937835617`*^9}, {3.897559221767798*^9, 
   3.897559234437376*^9}, {3.897559296325962*^9, 3.897559300029622*^9}, {
   3.8975593605168247`*^9, 3.897559395895697*^9}, {3.897568589095602*^9, 
   3.897568592647971*^9}, {3.8979059240596848`*^9, 3.897905943629613*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"9e3f27a0-8ae2-4642-8ed6-7d268d0f5131"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "graphD5", "]"}], "\[IndentingNewLine]", 
 RowBox[{"graphD5", "=", 
  RowBox[{"chemicalSpaceNetwork", "[", 
   RowBox[{"\"\<../../Data/D5Activities.csv\>\"", ",", "0.5", ",", 
    RowBox[{"\"\<BioData\>\"", "->", "True"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.897570516548542*^9, 3.8975705201777353`*^9}, {
   3.897570952096622*^9, 3.8975709825389214`*^9}, {3.8975718173190203`*^9, 
   3.897571828888277*^9}, {3.8975722766355047`*^9, 3.8975722811456337`*^9}, {
   3.897573399324234*^9, 3.89757339959227*^9}, {3.8975735570762243`*^9, 
   3.897573592215281*^9}, {3.897573660641818*^9, 3.897573661244005*^9}, {
   3.8975969015661583`*^9, 3.897596925570182*^9}, {3.897641368431775*^9, 
   3.8976413834810047`*^9}, {3.8976438334397*^9, 3.897643833839292*^9}, {
   3.897902243713562*^9, 3.897902254595624*^9}, {3.897904990643918*^9, 
   3.897904998005228*^9}, 3.8979080949109497`*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"852924ed-e133-4ea7-9bcf-91be32d9b452"],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorCommunities", "[", "graph_", "]"}], ":=", 
  RowBox[{"HighlightGraph", "[", 
   RowBox[{"graph", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Subgraph", "[", 
        RowBox[{"graphD5", ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"FindGraphCommunities", "[", "graph", "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8976579539447823`*^9, 3.89765796666525*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"c28f8504-5b1d-485c-baf7-d39762d64e12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawMolecules", "[", 
   RowBox[{"fingerprintData_Data", ",", "bioData_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{"bioData", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pos", ",", "v", ",", "size"}], "}"}], "|->", 
     RowBox[{"Inset", "[", 
      RowBox[{
       RowBox[{"MoleculePlot", "[", 
        RowBox[{
         RowBox[{"fingerprintData", "[", 
          RowBox[{"v", ",", "\"\<Molecule\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<HighlightColors\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"defualtpKiToColor", "[", 
               RowBox[{"fingerprintData", "[", 
                RowBox[{"v", ",", "\"\<pKi\>\""}], "]"}], "]"}], "}"}]}], ",", 
            RowBox[{"\"\<HighlightRadius\>\"", " ", "->", " ", "0.25"}], ",", 
            
            RowBox[{"\"\<HighlightedBondStyle\>\"", " ", "->", " ", "Gray"}], 
            ",", 
            RowBox[{"\"\<HighlightedAtomStyle\>\"", " ", "->", " ", "Gray"}], 
            ",", " ", 
            RowBox[{"\"\<DashStyle\>\"", " ", "->", " ", "Gray"}], ",", " ", 
            RowBox[{"\"\<WedgeStyle\>\"", " ", "->", " ", "Gray"}]}], "}"}]}],
          ",", 
         RowBox[{"ImageSize", "->", "80"}], ",", 
         RowBox[{"ColorRules", "->", 
          RowBox[{"{", 
           RowBox[{"_", "->", "Black"}], "}"}]}]}], "]"}], ",", "pos"}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pos", ",", "v", ",", "size"}], "}"}], "|->", 
     RowBox[{"Inset", "[", 
      RowBox[{
       RowBox[{"MoleculePlot", "[", 
        RowBox[{
         RowBox[{"fingerprintData", "[", 
          RowBox[{"v", ",", "\"\<Molecule\>\""}], "]"}], ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"\"\<HighlightColors\>\"", "->", "Automatic"}], "}"}]}], 
         ",", 
         RowBox[{"ImageSize", "->", "80"}]}], "]"}], ",", "pos"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.897904651300947*^9, 3.897904923863327*^9}, {
  3.897905778829507*^9, 3.897905782926834*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7a2bbc51-abe0-4e77-aa93-683219db2b3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"defaultVertexStyle", "=", 
   RowBox[{
    RowBox[{"#", "->", 
     RowBox[{"defualtpKiToColor", "[", 
      RowBox[{"$fingerprintData", "[", 
       RowBox[{"#", ",", "\"\<pKi\>\""}], "]"}], "]"}]}], "&"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8979055746848917`*^9, 3.897905630632876*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"aa497742-5d2f-46e0-a3fb-bbc8a25c2396"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vertexClicked", "=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"graph", "=", "graphD5"}], ",", 
     RowBox[{"edges", "=", 
      RowBox[{"EdgeList", "[", "graphD5", "]"}]}], ",", 
     RowBox[{"vertices", "=", 
      RowBox[{"Union", "@@", 
       RowBox[{"List", "@@@", 
        RowBox[{"EdgeList", "[", "graphD5", "]"}]}]}]}], ",", 
     RowBox[{"clickable", "=", "False"}], ",", 
     RowBox[{"bioData", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Panel", "[", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ActionMenu", "[", 
            RowBox[{"\"\<Communities\>\"", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Highlight\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"graph", "=", 
                  RowBox[{"colorCommunities", "[", "graph", "]"}]}], ")"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Export\>\"", ":>", 
                RowBox[{"Export", "[", 
                 RowBox[{"\"\<communities.wxf\>\"", ",", 
                  RowBox[{"FindGraphCommunities", "[", "graph", "]"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ActionMenu", "[", 
            RowBox[{"\"\<Connected components\>\"", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Highlight\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"graph", "=", 
                  RowBox[{"HighlightGraph", "[", 
                   RowBox[{"graph", ",", 
                    RowBox[{"ConnectedComponents", "[", "graph", "]"}]}], 
                   "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Export\>\"", ":>", 
                RowBox[{"Export", "[", 
                 RowBox[{"\"\<connectedComponents.wxf\>\"", ",", 
                  RowBox[{"ConnectedComponents", "[", "graph", "]"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ActionMenu", "[", 
            RowBox[{"\"\<Subgraph\>\"", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Generate from selected\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"graph", "=", 
                  RowBox[{"Subgraph", "[", 
                   RowBox[{"graph", ",", "vertexClicked", ",", 
                    RowBox[{"VertexStyle", "->", "Automatic"}]}], "]"}]}], 
                 ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Export\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"Export", "[", 
                  RowBox[{
                   RowBox[{"StringJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<subgraph\>\"", ",", "vertexClicked", ",", 
                    "\"\<.wxf\>\""}], "}"}], "]"}], ",", "graph"}], "]"}], 
                 ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ActionMenu", "[", 
            RowBox[{"\"\<Adjacency Matrix\>\"", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Export\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"Export", "[", 
                  RowBox[{"\"\<graphAdjMatrix.wxf\>\"", ",", 
                   RowBox[{"WeightedAdjacencyMatrix", "[", "graph", "]"}]}], 
                  "]"}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Export Spectra\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"Export", "[", 
                  RowBox[{"\"\<adjMatrixSpectra.wxf\>\"", ",", 
                   RowBox[{"Eigenvalues", "[", 
                    RowBox[{"WeightedAdjacencyMatrix", "[", "graphD5", "]"}], 
                    "]"}]}], "]"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ActionMenu", "[", 
            RowBox[{"\"\<Switch Embedding\>\"", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"\"\<Spring Electrical\>\"", ":>", 
               RowBox[{"(", 
                RowBox[{"graph", "=", 
                 RowBox[{"Annotate", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{
                   "GraphLayout", "->", 
                    "\"\<SpringElectricalEmbedding\>\""}]}], "]"}]}], ")"}]}],
               "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ActionMenu", "[", 
            RowBox[{"\"\<Reset\>\"", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Graph\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"graph", "=", "graphD5"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<Selected\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{"vertexClicked", "=", 
                  RowBox[{"{", "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<All\>\"", ":>", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"graph", "=", "graphD5"}], ";", 
                  RowBox[{"vertexClicked", "=", 
                   RowBox[{"{", "}"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
              "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Select Vertices\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"clickable", "=", 
               RowBox[{"Not", "[", "clickable", "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{"clickable", ",", 
                RowBox[{
                 RowBox[{"graph", "=", 
                  RowBox[{"Annotate", "[", 
                   RowBox[{"graph", ",", "\[IndentingNewLine]", 
                    RowBox[{"VertexShapeFunction", "->", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"EventHandler", "[", 
                    RowBox[{
                    RowBox[{"Disk", "[", 
                    RowBox[{"#1", ",", "0.05"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "\"\<MouseClicked\>\"", ":>", "\[IndentingNewLine]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"vertexClicked", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"vertexClicked", ",", "#2"}], "]"}]}], ";", 
                    RowBox[{"graph", "=", 
                    RowBox[{"Annotate", "[", 
                    RowBox[{"graph", ",", 
                    RowBox[{"VertexStyle", "->", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"vertexClicked", "->", "Red"}], "]"}]}]}], 
                    "]"}]}], ";"}], ")"}]}]}], "]"}], "&"}], ")"}]}]}], 
                   "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"graph", "=", 
                 RowBox[{"Annotate", "[", 
                  RowBox[{"graph", ",", 
                   RowBox[{"VertexShapeFunction", "->", "Automatic"}]}], 
                  "]"}]}]}], "]"}], ";"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Show distances\>\"", ",", 
             RowBox[{"(", 
              RowBox[{"graph", "=", 
               RowBox[{"Annotate", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"EdgeLabels", "->", "\"\<EdgeWeight\>\""}]}], 
                "]"}]}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Show Molecules\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{"graph", "=", 
               RowBox[{"Annotate", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"VertexShapeFunction", "->", 
                  RowBox[{"drawMolecules", "[", 
                   RowBox[{"$fingerprintData", ",", "bioData"}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}]}], ")"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Show Bio Data\>\"", ",", 
             RowBox[{
              RowBox[{"bioData", "=", "True"}], ";", "\[IndentingNewLine]", 
              RowBox[{"graph", "=", 
               RowBox[{"Annotate", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"VertexStyle", "->", 
                  RowBox[{"defaultVertexStyle", "/@", "vertices"}]}]}], 
                "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Draw Edge Weights\>\"", ",", 
             RowBox[{"graph", "=", 
              RowBox[{"graph", "//", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"IGEdgeMap", "[", 
                 RowBox[{"Identity", ",", 
                  RowBox[{"\"\<weight\>\"", "->", 
                   RowBox[{"IGEdgeProp", "[", "EdgeWeight", "]"}]}]}], "]"}], 
                "/*", "\[IndentingNewLine]", 
                RowBox[{"IGEdgeMap", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Directive", "[", 
                    RowBox[{"AbsoluteThickness", "[", 
                    RowBox[{"9", " ", "#1"}], "]"}], "]"}], "&"}], ",", 
                  RowBox[{"EdgeStyle", "->", 
                   RowBox[{"{", 
                    RowBox[{"IGEdgeProp", "[", "\"\<weight\>\"", "]"}], 
                    "}"}]}]}], "]"}]}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Panel", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "graph", "]"}], ",", 
          RowBox[{"ImageSize", "->", "Full"}], ",", 
          RowBox[{"Alignment", "->", "Center"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"Alignment", "->", "Center"}]}], "]"}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.897655164656643*^9, 3.897655269690185*^9}, {
   3.89765530291199*^9, 3.897655609411001*^9}, {3.897655643619697*^9, 
   3.897655858472313*^9}, {3.897655891437516*^9, 3.897655897402966*^9}, {
   3.897657746593268*^9, 3.8976579421242733`*^9}, 3.897657978799637*^9, {
   3.897658021347492*^9, 3.8976580731937933`*^9}, {3.897658111887741*^9, 
   3.8976582376323423`*^9}, {3.8976582686831093`*^9, 3.89765834942638*^9}, {
   3.897658436132053*^9, 3.897658488401744*^9}, {3.8976585447361727`*^9, 
   3.8976585661748457`*^9}, {3.897658610979274*^9, 3.8976586833829603`*^9}, {
   3.8976587148020906`*^9, 3.897658730583857*^9}, {3.897658764355722*^9, 
   3.897658802138524*^9}, {3.897658920597939*^9, 3.8976589380693007`*^9}, {
   3.897659013714634*^9, 3.8976590810483837`*^9}, {3.897659111624838*^9, 
   3.897659164129986*^9}, {3.897659224423716*^9, 3.8976592281080923`*^9}, {
   3.897659280725618*^9, 3.8976592896006613`*^9}, {3.897659323181239*^9, 
   3.897659337246078*^9}, {3.897659493186513*^9, 3.8976595318678703`*^9}, {
   3.897659568329213*^9, 3.897659624185362*^9}, {3.897659692808943*^9, 
   3.897659695392701*^9}, {3.897659805732833*^9, 3.8976599156725073`*^9}, {
   3.8976601868795443`*^9, 3.897660407495219*^9}, {3.897660438943775*^9, 
   3.897660469594305*^9}, {3.8976605275852337`*^9, 3.897660604567429*^9}, {
   3.8976606388851357`*^9, 3.8976606497688093`*^9}, {3.8976606840284357`*^9, 
   3.8976608118254023`*^9}, {3.897660925875684*^9, 3.897661115307838*^9}, {
   3.8976612972938213`*^9, 3.897661474175487*^9}, {3.897661568245111*^9, 
   3.897661587371711*^9}, {3.897661619826313*^9, 3.897661621725873*^9}, {
   3.897661730488019*^9, 3.897661732241238*^9}, {3.8976617861127872`*^9, 
   3.8976618993837337`*^9}, {3.897661954128509*^9, 3.8976619786029987`*^9}, {
   3.897662015313218*^9, 3.8976620521618357`*^9}, {3.8976621253540277`*^9, 
   3.897662154846044*^9}, {3.897662187149267*^9, 3.89766222941214*^9}, {
   3.897662260871023*^9, 3.897662295187994*^9}, {3.897662399022444*^9, 
   3.897662422292616*^9}, {3.897902124707036*^9, 3.897902150099592*^9}, {
   3.897902186161499*^9, 3.8979022316312857`*^9}, {3.897902344674465*^9, 
   3.897902410786557*^9}, {3.897902445893838*^9, 3.897902472099865*^9}, {
   3.897902512080724*^9, 3.8979027119327097`*^9}, {3.89790277073125*^9, 
   3.897902798144153*^9}, {3.8979028285652447`*^9, 3.897902867715844*^9}, {
   3.897902927839118*^9, 3.89790302075737*^9}, {3.897903058331357*^9, 
   3.89790305970877*^9}, {3.897903095064011*^9, 3.897903135649579*^9}, {
   3.897903172217008*^9, 3.897903192220755*^9}, 3.897903236488776*^9, {
   3.8979033167525787`*^9, 3.897903601669816*^9}, {3.897903646705781*^9, 
   3.897903662415732*^9}, {3.8979036926998672`*^9, 3.897903735318656*^9}, {
   3.897903777786199*^9, 3.897903814585958*^9}, {3.897903871975675*^9, 
   3.897903876933557*^9}, {3.897903923915924*^9, 3.897903969935861*^9}, {
   3.897904000853478*^9, 3.8979040261663303`*^9}, {3.8979040684020243`*^9, 
   3.897904173286049*^9}, {3.897904307076582*^9, 3.897904326745722*^9}, {
   3.897904416184517*^9, 3.8979044972431173`*^9}, {3.8979045305041037`*^9, 
   3.897904600892295*^9}, 3.897904687171413*^9, {3.897904931054673*^9, 
   3.8979049607203693`*^9}, {3.897905018071069*^9, 3.897905081402272*^9}, {
   3.897905113714262*^9, 3.897905202349338*^9}, {3.8979052683651733`*^9, 
   3.897905269497346*^9}, {3.897905401340928*^9, 3.8979054253878927`*^9}, {
   3.897905484137179*^9, 3.897905543416223*^9}, {3.897905651346352*^9, 
   3.897905656088026*^9}, {3.897905822385684*^9, 3.897905913206497*^9}, {
   3.897905966679521*^9, 3.897905968270351*^9}, {3.89790600215451*^9, 
   3.8979060438605423`*^9}, {3.897906254162674*^9, 3.897906339699976*^9}, {
   3.897906407499374*^9, 3.897906452563102*^9}, {3.8979065252912197`*^9, 
   3.897906549243607*^9}, 3.897906722030855*^9, {3.897906799223847*^9, 
   3.8979068186873302`*^9}, {3.897906853236415*^9, 3.897906893342656*^9}, {
   3.897907343918314*^9, 3.897907427687523*^9}, {3.897907458848474*^9, 
   3.8979074592973833`*^9}, {3.897907491802937*^9, 3.897907518035221*^9}, {
   3.897907581716566*^9, 3.897907659418263*^9}, {3.897907848653919*^9, 
   3.897907850226143*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"55d89b25-929d-4d09-b8f4-a28fae3b2db6"],

Cell[BoxData[
 TemplateBox[{
  "Union", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Union\\\", \\\"[\\\", \
\\\"Null\\\", \\\"]\\\"}]\\).\"", 2, 157, 43, 23028987638045145018, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.897908102983357*^9, 3.8979086850710297`*^9},
 CellLabel->
  "During evaluation of \
In[157]:=",ExpressionUUID->"7618b668-18dd-4407-b889-564a79dbc5ca"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`vertexClicked$$ = {}, $CellContext`graph$$ = 
  Null, $CellContext`edges$$ = EdgeList[Null], $CellContext`vertices$$ = 
  Union[Null], $CellContext`clickable$$ = False, $CellContext`bioData$$ = 
  False}, 
  PanelBox[
   TagBox[GridBox[{
      {
       TemplateBox[{
         ActionMenuBox[
         "\"Communities\"", {
          "\"Highlight\"" :> ($CellContext`graph$$ = \
$CellContext`colorCommunities[$CellContext`graph$$]), "\"Export\"" :> 
           Export["communities.wxf", 
             FindGraphCommunities[$CellContext`graph$$]]}], 
         ActionMenuBox[
         "\"Connected components\"", {
          "\"Highlight\"" :> ($CellContext`graph$$ = 
            HighlightGraph[$CellContext`graph$$, 
              ConnectedComponents[$CellContext`graph$$]]), "\"Export\"" :> 
           Export["connectedComponents.wxf", 
             ConnectedComponents[$CellContext`graph$$]]}], 
         ActionMenuBox[
         "\"Subgraph\"", {
          "\"Generate from selected\"" :> ($CellContext`graph$$ = 
            Subgraph[$CellContext`graph$$, $CellContext`vertexClicked$$, 
              VertexStyle -> Automatic]), "\"Export\"" :> Export[
             
             StringJoin[{
              "subgraph", $CellContext`vertexClicked$$, 
               ".wxf"}], $CellContext`graph$$]}], 
         ActionMenuBox[
         "\"Adjacency Matrix\"", {"\"Export\"" :> Export["graphAdjMatrix.wxf", 
             WeightedAdjacencyMatrix[$CellContext`graph$$]], 
           "\"Export Spectra\"" :> Export["adjMatrixSpectra.wxf", 
             Eigenvalues[
              WeightedAdjacencyMatrix[$CellContext`graphD5]]]}], 
         ActionMenuBox[
         "\"Switch Embedding\"", {
          "\"Spring Electrical\"" :> ($CellContext`graph$$ = 
            Annotate[$CellContext`graph$$, GraphLayout -> 
              "SpringElectricalEmbedding"])}], 
         ActionMenuBox[
         "\"Reset\"", {
          "\"Graph\"" :> ($CellContext`graph$$ = $CellContext`graphD5), 
           "\"Selected\"" :> ($CellContext`vertexClicked$$ = {}), 
           "\"All\"" :> ($CellContext`graph$$ = $CellContext`graphD5; \
$CellContext`vertexClicked$$ = {})}]},
        "RowDefault"]},
      {
       TemplateBox[{
         ButtonBox[
         "\"Select Vertices\"", 
          ButtonFunction :> ($CellContext`clickable$$ = 
            Not[$CellContext`clickable$$]; 
           If[$CellContext`clickable$$, $CellContext`graph$$ = 
              Annotate[$CellContext`graph$$, 
                VertexShapeFunction -> (EventHandler[
                  Disk[#, 0.05], 
                  "MouseClicked" :> ($CellContext`vertexClicked$$ = 
                    Append[$CellContext`vertexClicked$$, #2]; \
$CellContext`graph$$ = 
                    Annotate[$CellContext`graph$$, VertexStyle -> 
                    Thread[$CellContext`vertexClicked$$ -> Red]]; Null)]& )]; 
             Null, $CellContext`graph$$ = 
             Annotate[$CellContext`graph$$, VertexShapeFunction -> 
               Automatic]]; Null), Appearance -> Automatic, Evaluator -> 
          Automatic, Method -> "Preemptive"], 
         ButtonBox[
         "\"Show distances\"", 
          ButtonFunction :> ($CellContext`graph$$ = 
           Annotate[$CellContext`graph$$, EdgeLabels -> "EdgeWeight"]), 
          Appearance -> Automatic, Evaluator -> Automatic, Method -> 
          "Preemptive"], 
         ButtonBox[
         "\"Show Molecules\"", 
          ButtonFunction :> ($CellContext`graph$$ = 
           Annotate[$CellContext`graph$$, 
             VertexShapeFunction -> \
$CellContext`drawMolecules[$CellContext`$fingerprintData, \
$CellContext`bioData$$]]), Appearance -> Automatic, Evaluator -> Automatic, 
          Method -> "Preemptive"], 
         ButtonBox[
         "\"Show Bio Data\"", 
          ButtonFunction :> ($CellContext`bioData$$ = 
            True; $CellContext`graph$$ = 
            Annotate[$CellContext`graph$$, VertexStyle -> 
              Map[$CellContext`defaultVertexStyle, $CellContext`vertices$$]]),
           Appearance -> Automatic, Evaluator -> Automatic, Method -> 
          "Preemptive"], 
         ButtonBox[
         "\"Draw Edge Weights\"", 
          ButtonFunction :> ($CellContext`graph$$ = RightComposition[
             IGraphM`IGEdgeMap[
             Identity, "weight" -> IGraphM`IGEdgeProp[EdgeWeight]], 
             IGraphM`IGEdgeMap[Directive[
               AbsoluteThickness[9 #]]& , EdgeStyle -> {
                IGraphM`IGEdgeProp["weight"]}]][$CellContext`graph$$]), 
          Appearance -> Automatic, Evaluator -> Automatic, Method -> 
          "Preemptive"]},
        "RowDefault"]},
      {
       PanelBox[
        DynamicBox[ToBoxes[$CellContext`graph$$, StandardForm],
         ImageSizeCache->{23., {0.115966796875, 9.19189453125}}],
        Alignment->Center,
        ImageSize->Full]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Column"]],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{
  3.897905914456601*^9, 3.897905953944508*^9, 3.8979060096113253`*^9, 
   3.897906044933744*^9, 3.89790689409002*^9, 3.897907402021226*^9, 
   3.897907526507704*^9, {3.897907583142934*^9, 3.897907620477395*^9}, 
   3.897907734540497*^9, 3.897907854244671*^9, 3.897908102987507*^9, 
   3.897908685078425*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"0dcea6f0-4911-4846-a85b-a1f3fc563ce3"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.897662058875388*^9, 
  3.8976620611751423`*^9}},ExpressionUUID->"318e0c9a-e212-475f-b494-\
741f92508bc2"]
},
WindowSize->{Full, Full},
WindowMargins->{{171, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (June 8, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13b94586-7e1d-4065-a602-3880602b28b4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[583, 22, 324, 7, 57, "Input",ExpressionUUID->"89a1c28e-04f8-490d-9f99-8b8f42a52b01",
 InitializationCell->True],
Cell[910, 31, 863, 14, 69, "Output",ExpressionUUID->"f4ac12c7-aad5-417d-bea2-051d5d311eca",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1810, 50, 170, 4, 57, "Input",ExpressionUUID->"f3045fcd-3c29-4015-aafe-d45fbe3c7fbf",
 InitializationCell->True],
Cell[1983, 56, 566, 12, 67, "Output",ExpressionUUID->"c587e3bb-c9ea-4017-a7f9-16a1a2206820"]
}, Open  ]],
Cell[2564, 71, 306, 6, 57, "Input",ExpressionUUID->"dfc0a8e7-c3a8-4b33-9207-b299d1f1f1b6",
 InitializationCell->True],
Cell[2873, 79, 236, 4, 57, "Input",ExpressionUUID->"f44a5f93-15a8-4afb-86ab-f3af63db4ac2",
 InitializationCell->True],
Cell[3112, 85, 1067, 22, 240, "Input",ExpressionUUID->"e19d7f81-6f45-4e16-b11e-8a6d9f3bb150",
 InitializationCell->True],
Cell[4182, 109, 3665, 78, 448, "Input",ExpressionUUID->"beb8e9ba-a476-41e4-ad6c-c0c6e6971a38",
 InitializationCell->True],
Cell[7850, 189, 3267, 81, 344, "Input",ExpressionUUID->"f9965f40-3dfb-4084-a4a0-e97fc3161afd",
 InitializationCell->True],
Cell[11120, 272, 4215, 96, 370, "Input",ExpressionUUID->"b3f3e12d-3a33-474c-983d-40c43ba7d4db",
 InitializationCell->True],
Cell[15338, 370, 3947, 93, 448, "Input",ExpressionUUID->"9e3f27a0-8ae2-4642-8ed6-7d268d0f5131",
 InitializationCell->True],
Cell[19288, 465, 1009, 16, 64, "Input",ExpressionUUID->"852924ed-e133-4ea7-9bcf-91be32d9b452"],
Cell[20300, 483, 527, 13, 64, "Input",ExpressionUUID->"c28f8504-5b1d-485c-baf7-d39762d64e12"],
Cell[20830, 498, 2344, 56, 246, "Input",ExpressionUUID->"7a2bbc51-abe0-4e77-aa93-683219db2b3b"],
Cell[23177, 556, 411, 10, 37, "Input",ExpressionUUID->"aa497742-5d2f-46e0-a3fb-bbc8a25c2396"],
Cell[CellGroupData[{
Cell[23613, 570, 15023, 289, 1520, "Input",ExpressionUUID->"55d89b25-929d-4d09-b8f4-a28fae3b2db6"],
Cell[38639, 861, 471, 10, 35, "Message",ExpressionUUID->"7618b668-18dd-4407-b889-564a79dbc5ca"],
Cell[39113, 873, 5515, 120, 158, "Output",ExpressionUUID->"0dcea6f0-4911-4846-a85b-a1f3fc563ce3"]
}, Open  ]],
Cell[44643, 996, 154, 3, 37, "Input",ExpressionUUID->"318e0c9a-e212-475f-b494-741f92508bc2"]
}
]
*)

